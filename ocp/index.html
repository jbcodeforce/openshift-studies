<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=../k8s/k8s-comp/ rel=prev><link href=../os-cn-dev/ rel=next><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.4.2, mkdocs-material-9.0.6"><title>Introduction - Kubernetes Studies</title><link rel=stylesheet href=../assets/stylesheets/main.558e4712.min.css><link rel=stylesheet href=../assets/stylesheets/palette.2505c338.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../extra.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary data-md-color-accent> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#openshift-studies class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="Kubernetes Studies" class="md-header__button md-logo" aria-label="Kubernetes Studies" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Kubernetes Studies </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Introduction </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jbcodeforce/openshift-studies title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Kubernetes Studies" class="md-nav__button md-logo" aria-label="Kubernetes Studies" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> Kubernetes Studies </label> <div class=md-nav__source> <a href=https://github.com/jbcodeforce/openshift-studies title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> Introduction </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 tabindex=0 aria-expanded=false> Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Kubernetes data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../k8s/k8s-0/ class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../k8s/k8s-1/ class=md-nav__link> Networking </a> </li> <li class=md-nav__item> <a href=../k8s/k8s-2/ class=md-nav__link> Security </a> </li> <li class=md-nav__item> <a href=../k8s/k8s-3/ class=md-nav__link> Demo it </a> </li> <li class=md-nav__item> <a href=../k8s/k8s-faq/ class=md-nav__link> FAQ </a> </li> <li class=md-nav__item> <a href=../k8s/k8s-comp/ class=md-nav__link> Compendium </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 tabindex=0 aria-expanded=true> Openshift <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Openshift data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Openshift </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Introduction <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Introduction </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#cncf class=md-nav__link> CNCF </a> </li> <li class=md-nav__item> <a href=#concepts class=md-nav__link> Concepts </a> </li> <li class=md-nav__item> <a href=#getting-started class=md-nav__link> Getting started </a> </li> <li class=md-nav__item> <a href=#collaborate class=md-nav__link> Collaborate </a> </li> <li class=md-nav__item> <a href=#monitoring class=md-nav__link> Monitoring </a> <nav class=md-nav aria-label=Monitoring> <ul class=md-nav__list> <li class=md-nav__item> <a href=#monitoring-overview-ocp48 class=md-nav__link> Monitoring Overview - OCP4.8 </a> </li> <li class=md-nav__item> <a href=#configuration class=md-nav__link> Configuration: </a> </li> <li class=md-nav__item> <a href=#day-2-for-monitoring class=md-nav__link> Day 2 for monitoring </a> </li> <li class=md-nav__item> <a href=#custom-dashboard class=md-nav__link> Custom dashboard </a> </li> <li class=md-nav__item> <a href=#read-more class=md-nav__link> Read more </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../os-cn-dev/ class=md-nav__link> Cloud Native Development </a> </li> <li class=md-nav__item> <a href=cp4i/ class=md-nav__link> Cloud Pak Integration </a> </li> <li class=md-nav__item> <a href=faq/ class=md-nav__link> FAQ </a> </li> <li class=md-nav__item> <a href=oc-cli/ class=md-nav__link> oc CLI </a> </li> <li class=md-nav__item> <a href=../deployment-ex/ class=md-nav__link> Deployment examples </a> </li> <li class=md-nav__item> <a href=notes-ocp-training/ class=md-nav__link> Notes from certification </a> </li> <li class=md-nav__item> <a href=../spark-on-os/ class=md-nav__link> Operators (with Spark) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 tabindex=0 aria-expanded=false> Operations <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Operations data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Operations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../sre/ class=md-nav__link> SRE </a> </li> <li class=md-nav__item> <a href=../ansible/ class=md-nav__link> Ansible </a> </li> <li class=md-nav__item> <a href=../spark-on-os/ class=md-nav__link> Operators (with Spark) </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../compendium/ class=md-nav__link> Compendium </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io class=md-nav__link> Return to main </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#cncf class=md-nav__link> CNCF </a> </li> <li class=md-nav__item> <a href=#concepts class=md-nav__link> Concepts </a> </li> <li class=md-nav__item> <a href=#getting-started class=md-nav__link> Getting started </a> </li> <li class=md-nav__item> <a href=#collaborate class=md-nav__link> Collaborate </a> </li> <li class=md-nav__item> <a href=#monitoring class=md-nav__link> Monitoring </a> <nav class=md-nav aria-label=Monitoring> <ul class=md-nav__list> <li class=md-nav__item> <a href=#monitoring-overview-ocp48 class=md-nav__link> Monitoring Overview - OCP4.8 </a> </li> <li class=md-nav__item> <a href=#configuration class=md-nav__link> Configuration: </a> </li> <li class=md-nav__item> <a href=#day-2-for-monitoring class=md-nav__link> Day 2 for monitoring </a> </li> <li class=md-nav__item> <a href=#custom-dashboard class=md-nav__link> Custom dashboard </a> </li> <li class=md-nav__item> <a href=#read-more class=md-nav__link> Read more </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=openshift-studies>OpenShift Studies<a class=headerlink href=#openshift-studies title="Permanent link">&para;</a></h1> <p>OpenShift Container Platform is about developing, deploying, and running <a href=/docker>containerized</a> applications. It is based on docker and Kubernetes and add the following features:</p> <ul> <li><strong>Routes</strong>: represents the way external clients are able to access applications running on OpenShift. The default OpenShift router (HAProxy) uses the HTTP header of the incoming request to determine where to proxy the connection.</li> <li><strong><a href=https://docs.openshift.com/container-platform/4.1/applications/deployments/what-deployments-are.html>Deployment config</a></strong>: Represents the set of containers included in a pod, and the deployment strategies to be used. DeploymentConfigs involve one or more ReplicationControllers, which contain a point-in-time record of the state of a DeploymentConfig as a Pod template</li> <li>CLI, <a href=https://docs.OpenShift.org/latest/rest_api/index.html>REST API</a> for administration or Web Console</li> <li>Multi tenants. You can also grant other users access to any of your projects. </li> <li><a href=https://docs.OpenShift.org/latest/creating_images/s2i.html>Source-to-image (S2I)</a> is a tool for building reproducible Docker images. S2I supports incremental builds which re-use previously downloaded dependencies, and previously built artifacts. OpenShift is S2I-enabled and can use S2I as one of its build mechanisms.</li> <li> <p><strong>Build config</strong>: Used by the OpenShift Source-to-Image (S2I) feature to build a container image from application source code stored in a Git repository</p> </li> <li> <p>OpenShift for production comes in several variants:</p> <ul> <li>OpenShift Origin: from <a href=http://OpenShift.org>http://OpenShift.org</a></li> <li>OpenShift Container Platform: integrated with RHEL and supported by RedHat. It allows for building a private or public PaaS cloud.</li> <li>OpenShift Online: multi-tenant public cloud managed by Red Hat</li> <li>OpenShift Dedicated: single-tenant container application platform hosted on Amazon Web Services (AWS) or Google Cloud Platform and managed by Red Hat.</li> </ul> </li> </ul> <p>See also <a href=../k8s/k8s-0/ >my summary on k8s</a>.</p> <h2 id=cncf>CNCF<a class=headerlink href=#cncf title="Permanent link">&para;</a></h2> <p>Cloud Native Computing Foundation project helps to accelerate the adoption of container, micro services, orchestrator and cloud native app.</p> <ul> <li>containerd for Container Runtime</li> <li>rkt for Container Runtime</li> <li>Kubernetes for Container Orchestration</li> <li>Linkerd or ISTIO for Service Mesh</li> <li>gRPC for Remote Procedure Call</li> <li>Container Network Interface (CNI) for Container Networking</li> <li>CoreDNS for Service Discovery</li> <li>Prometheus for Monitoring</li> <li>OpenTracing for Tracing</li> <li>Fluentd for Logging.</li> </ul> <h2 id=concepts>Concepts<a class=headerlink href=#concepts title="Permanent link">&para;</a></h2> <p>OpenShift is based on Kubernetes. It adds the concept of <strong>project</strong>, mapped to a k8s namespace, to govern the application access control, resource quota and application's life cycle. Project is the top-level element for one to many applications.</p> <p>We can deploy any docker image, as soon as they are well built: such as defining the port any service is exposed on, not needing to run specifically as the root user or other dedicated user, and which embeds a default command for running the application.</p> <p>Routes are used to expose app over HTTP. OpenShift can handle termination for secure HTTP connections, or a secure connection can be tunneled through the application, with the application handling termination of the secure connection. Non HTTP applications can be exposed via a tunneled secure connection if the client supports the SNI extension for a secure connection using TLS. A router (ingress controller) forwards HTTP and TLS requests to the service addresses inside the Kubernetes SDN.</p> <p>OpenShift routes are implemented by a cluster-wide router service, which runs as a containerized application in the OpenShift cluster. The router service uses HAProxy as the default implementation.</p> <p><a href=https://developer.ibm.com/openlabs/OpenShift>Red Hat OpenShift on IBM Cloud</a> is a preconfigured OpenShift environment available for four hours at no charge. </p> <p><a href=/notes-ocp-training>Note from the Red Hat OpenShift training</a></p> <h2 id=getting-started>Getting started<a class=headerlink href=#getting-started title="Permanent link">&para;</a></h2> <p>Use IBM Cloud cluster feature to get an OpenShift cluster.</p> <p>Be familiar with <a href=../oc-cli.md>OC cli commands</a>.</p> <h2 id=collaborate>Collaborate<a class=headerlink href=#collaborate title="Permanent link">&para;</a></h2> <p>User can be added to an existing project, via the View membership menu on a project. Each user can have different roles. <code>Edit Role</code> can perform most tasks within the project, except tasks related to administration of the project.</p> <div class="admonition remark"> <p class=admonition-title>Remark</p> <p>State about the current login session is stored in the home directory of the local user running the <code>oc</code> command, so user needs to logout and login to access a second cluster. </p> </div> <h2 id=monitoring>Monitoring<a class=headerlink href=#monitoring title="Permanent link">&para;</a></h2> <p>The approach an organization takes to Monitoring and Alerting on events of importance is one of the most important considerations for an enterprise.</p> <p>The <strong>goal</strong> of any monitoring endeavor is to provide observability of the platform and applications so that one can "ask" questions to spot anomalies and un-cover the cause of an unplanned issue as quickly as possible.</p> <h3 id=monitoring-overview-ocp48><a href=https://docs.openshift.com/container-platform/4.8/monitoring/monitoring-overview.html>Monitoring Overview - OCP4.8</a><a class=headerlink href=#monitoring-overview-ocp48 title="Permanent link">&para;</a></h3> <ul> <li>OpenShift Container Platform includes a preconfigured, preinstalled, and self-updating monitoring stack that provides monitoring for core platform components.</li> <li>A set of alerts are included by default that immediately notify cluster administrators about issues with a cluster. </li> <li>Default dashboards in the OpenShift Container Platform web console include visual representations of cluster metrics to help you to quickly understand the state of your cluster.</li> <li>access to third-party interfaces, such as Prometheus, Alertmanager, and Grafana.</li> <li>The OpenShift Container Platform monitoring stack is based on the <a href=https://prometheus.io/ >Prometheus</a> open source project and its wider ecosystem. The namespace is <code>openshift-monitoring</code></li> </ul> <h3 id=configuration><a href=https://docs.openshift.com/container-platform/4.8/monitoring/configuring-the-monitoring-stack.html>Configuration</a>:<a class=headerlink href=#configuration title="Permanent link">&para;</a></h3> <ul> <li>To configure core OpenShift Container Platform monitoring components, you must create the cluster-monitoring-config ConfigMap object in the openshift-monitoring project.</li> </ul> <div class=highlight><pre><span></span><code>oc<span class=w> </span>-n<span class=w> </span>openshift-monitoring<span class=w> </span>get<span class=w> </span>configmap<span class=w> </span>cluster-monitoring-config
<span class=c1># if not present</span>
oc<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>-<span class=w> </span><span class=s>&lt;&lt;EOF</span>
<span class=s>apiVersion: v1</span>
<span class=s>kind: ConfigMap</span>
<span class=s>metadata:</span>
<span class=s>    name: cluster-monitoring-config</span>
<span class=s>    namespace: openshift-monitoring</span>
<span class=s>data:</span>
<span class=s>    config.yaml: |</span>
<span class=s>EOF</span>
</code></pre></div> <ul> <li>To configure the components that monitor user-defined projects, you must create the user-workload-monitoring-config ConfigMap object in the openshift-user-workload-monitoring project.</li> </ul> <div class=highlight><pre><span></span><code>oc<span class=w> </span>-n<span class=w> </span>openshift-user-workload-monitoring<span class=w> </span>get<span class=w> </span>configmap<span class=w> </span>user-workload-monitoring-config
<span class=c1># if not present</span>
oc<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>-<span class=w> </span><span class=s>&lt;&lt;EOF</span>
<span class=s>apiVersion: v1</span>
<span class=s>kind: ConfigMap</span>
<span class=s>metadata:</span>
<span class=s>    name: user-workload-monitoring-config</span>
<span class=s>    namespace: openshift-user-workload-monitoring</span>
<span class=s>data:</span>
<span class=s>    config.yaml: |</span>
<span class=s>EOF</span>
</code></pre></div> <p>Add any key-value under this configuration for each component to configure</p> <ul> <li> <p>See the <a href=https://docs.openshift.com/container-platform/4.8/monitoring/configuring-the-monitoring-stack.html#configurable-monitoring-components_configuring-the-monitoring-stack>Configurable monitoring components</a></p> </li> <li> <p>Many of the monitoring components are deployed by using multiple pods across different nodes in the cluster to maintain high availability.</p> </li> <li>Running cluster monitoring with persistent storage means that your metrics are stored to a persistent volume (PV) and can survive a pod being restarted or recreated. See <a href=https://docs.openshift.com/container-platform/4.8/scalability_and_performance/scaling-cluster-monitoring-operator.html#prometheus-database-storage-requirements_cluster-monitoring-operator>Prometheus database storage requirements</a></li> </ul> <h3 id=day-2-for-monitoring>Day 2 for monitoring<a class=headerlink href=#day-2-for-monitoring title="Permanent link">&para;</a></h3> <ul> <li>Viewing performance data in the login dashboard</li> <li>Viewing Prometheus metrics</li> <li>Confirm the default Grafana dashboards are available</li> <li>Verify actionable alerts are flowing to the correct destination</li> </ul> <p>Access Prometheus using <code>Monitoring &gt; Metrics &gt;</code> In the query field, enter your PromQL query.</p> <p><img alt src=images/prometheus-ocp-metrics.png></p> <p>Access Grafana with <code>Monitoring &gt; Dashboard &gt;</code></p> <p><img alt src=images/grafana-ocp.png></p> <p>Included with the Monitoring Stack are ~120 predefined alerts. The Alert Manager is available by selecting Alerts under the monitoring tab in the web console. Here are some <a href="https://grafana.com/grafana/dashboards/?search=OpenShift">Grafana OpenShift dashboards</a> that could be deployed in your own namespace.</p> <p>We recommend integrating the Alert Manager and any other Monitoring tools you use with your organizations event management solution.</p> <p>OCP provides Operators for integration with third party products such as New Relic, Sysdig, and Prometheus.</p> <h3 id=custom-dashboard>Custom dashboard<a class=headerlink href=#custom-dashboard title="Permanent link">&para;</a></h3> <ul> <li>Create a namespace</li> <li>Install community-powered Grafana Operator</li> <li>Create a new Grafana instance.</li> <li>Connect the community supported Grafana in the my-grafana namespace to OpenShift monitoring in the openshift-monitoring namespace</li> <li>Grant grafana-serviceaccount service account the cluster-monitoring-view cluster role.</li> </ul> <div class=highlight><pre><span></span><code>oc<span class=w> </span>adm<span class=w> </span>policy<span class=w> </span>add-cluster-role-to-user<span class=w> </span>cluster-monitoring-view<span class=w> </span>-z<span class=w> </span>grafana-serviceaccount
</code></pre></div> <ul> <li>The bearer token for this service account is used to authenticate access to Prometheus in the openshift-monitoring namespace. The following command will display this token.</li> </ul> <div class=highlight><pre><span></span><code>oc<span class=w> </span>serviceaccounts<span class=w> </span>get-token<span class=w> </span>grafana-serviceaccount<span class=w> </span>-n<span class=w> </span>my-grafana
</code></pre></div> <ul> <li>From the Grafana Data Source resource, press Create Instance, and navigate to the YAML view. In the below YAML, substitute ${BEARER_TOKEN} with the output of the command above.</li> <li>Use custom Grafana dashboards or create your own.</li> </ul> <h3 id=read-more>Read more<a class=headerlink href=#read-more title="Permanent link">&para;</a></h3> <ul> <li><a href=https://docs.openshift.com/container-platform/4.8/monitoring/enabling-monitoring-for-user-defined-projects.html>Product documentation - Enabling monitoring for user-defined projects</a></li> <li><a href=https://docs.openshift.com/container-platform/4.8/monitoring/configuring-the-monitoring-stack.html>Product documentation - configuring monitoring stack</a></li> <li><a href=https://github.ibm.com/CASE/OCP-Day2-operations/tree/master/Monitoring>OCP Day 2 Operations</a></li> <li><a href=https://www.redhat.com/en/blog/custom-grafana-dashboards-red-hat-openshift-container-platform-4>2020 - Custom Grafana dashboards for Red Hat OpenShift Container Platform 4</a></li> </ul> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["content.code.annotate", "content.tooltips", "navigation.instant", "navigation.expand", "navigation.tabs.sticky", "navigation.top"], "search": "../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.51d95adb.min.js></script> </body> </html>